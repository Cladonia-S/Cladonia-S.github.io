---
title: "[백준]11444번 - 피보나치수 6"
categoties: 코딩테스트
tags: [백준, 코딩테스트,알고리즘, python, 분할정복]
---

# 피보나치수 6

## 문제

피보나치 수는 0과 1로 시작한다. 0번째 피보나치 수는 0이고, 1번째 피보나치 수는 1이다. 그 다음 2번째 부터는 바로 앞 두 피보나치 수의 합이 된다.

이를 식으로 써보면 Fn = Fn-1 + Fn-2 (n ≥ 2)가 된다.

n=17일때 까지 피보나치 수를 써보면 다음과 같다.

0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597

n이 주어졌을 때, n번째 피보나치 수를 구하는 프로그램을 작성하시오.

### 입력

첫째 줄에 n이 주어진다. n은 1,000,000,000,000,000,000보다 작거나 같은 자연수이다.

### 출력

첫째 줄에 n번째 피보나치 수를 1,000,000,007으로 나눈 나머지를 출력한다.

## 문제풀이

이번에 피보나치 수열을 푸는 방법은 지금까지와는 조금 많이 다르다. 지금까지는 일일히 Fn식을 풀어서 전개했다면 이번에는 다른방법을 써서 풀어보게 될것이다. 그 다른방법이라고 함은 점화식을 조금 다르게 바꾸는 것인데 이런 점화식을 행렬화 해서 푸는것이다.

피보나치 수열을 행렬화 하면 다음과 같은데
$$
\begin{bmatrix}F_{n+1}&F_n\\F_n&F_{n-1}\end{bmatrix}=
\begin{bmatrix}F_n&F_{n-1}\\F_{n-1}&F_{n-2}\end{bmatrix} * \begin{bmatrix}1&1\\1&0\end{bmatrix}
$$
이를 반복하면  다음과 같아진다.
$$
{\begin{bmatrix}F_{n+1}&F_n\\F_n&F_{n-1}\end{bmatrix}}=
{\begin{bmatrix}F_n&F_{n-1}\\F_{n-1}&F_{n-2}\end{bmatrix} * \begin{bmatrix}1&1\\1&0\end{bmatrix}}   \\
={\begin{bmatrix}F_2&F_1\\F_1&F_0\end{bmatrix}*\begin{bmatrix}1&1\\1&0\end{bmatrix}^{n-2}}
\\
={\begin{bmatrix}2&1\\1&0\end{bmatrix}*\begin{bmatrix}1&1\\1&0\end{bmatrix}^{n-2}}
={\begin{bmatrix}1&1\\1&0\end{bmatrix}^{n}}
$$
즉,
$$
{\begin{bmatrix}F_{n+1}&F_n\\F_n&F_{n-1}\end{bmatrix}}=
{\begin{bmatrix}1&1\\1&0\end{bmatrix}^{n}}
$$
이 된다. 이 행렬제곱식을 이용해 제곱을 해주면 결과적으로 Fn값을 구할 수 있다. 또한 행렬 제곱을 분할정복을 통해 푸는 방법은 이전 문제들에서 많이 다뤘으므로 그것을 이용하면 된다.

### 의사코드

> 1. n을 입력받는다.
> 2. [[1,1],[1,0]]을 n-1제곱한다.
> 3. 결과값의\[0][0]을 출력한다.

### 파이썬 코드

```python
import sys
n=int(sys.stdin.readline())
A=[[1,1],[1,0]]
ret=[[1,0],[0,1]]
while n>0:
    if n%2==1:
        temp=[[0,0],[0,0]]
        temp[0][0]=(ret[0][0]*A[0][0]+ret[0][1]*A[1][0])%1000000007
        temp[0][1]=(ret[0][0]*A[0][1]+ret[0][1]*A[1][1])%1000000007
        temp[1][0]=(ret[1][0]*A[0][0]+ret[1][1]*A[1][0])%1000000007
        temp[1][1]=(ret[1][0]*A[0][1]+ret[1][1]*A[1][1])%1000000007
        ret=list(temp)
    temp=[[0,0],[0,0]]
    temp[0][0]=(A[0][0]*A[0][0]+A[0][1]*A[1][0])%1000000007
    temp[0][1]=(A[0][0]*A[0][1]+A[0][1]*A[1][1])%1000000007
    temp[1][0]=(A[1][0]*A[0][0]+A[1][1]*A[1][0])%1000000007
    temp[1][1]=(A[1][0]*A[0][1]+A[1][1]*A[1][1])%1000000007
    A=list(temp)
    n=n//2
print(ret[0][1])
```

